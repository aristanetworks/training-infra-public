<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Arista ATD Lab">

    <title>Arista {{ topo_title }}</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <script src="js/atd-ws.js"></script>

    <!-- Custom styles for this template -->
    <link href="css/simple-sidebar.css" rel="stylesheet">
    <style>
                #spinner{
            position: fixed;
            top:0;
            left: 0;
            opacity: 0.5;
            z-index: 60;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: white;   
        }
        #spinner img{
                height: 100px;
                width: 100px;
            }


    </style>
</head>

<body>
    <div id="loader" style="display: none;">
    <div id="spinner">
        <img  src="./images/loading.gif" alt="Description when image is not found" width="100" height="100">
        </div>
    </div>
    <div id="wrapper" class="toggled">

        <!-- Sidebar -->
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav">
                <br>
                <img src="images/logotransparent.png" class="arista-logo">
                <hr class="hr">
                <li>
                    <a style="color: white;cursor: pointer;" id="home"  target="_blank">Home</a>
                </li>
                {% if "labguides" not in disable_links %}
                <li>
                    <a href="{{ labguides }}" target="_blank">Lab Guides</a> <a href="/labguides/ATD.pdf" target="_blank">(PDF)</a>
                </li>
                {% end %}
                {% if "console" not in disable_links %}
                <li>
                    <a href="/ssh/host/192.168.0.1" target="_blank">Console Access</a>
                </li>
                {% end %}
                {% if "ide" not in disable_links %}
                <li>
                    <a href="/coder" target="_blank">Programmability IDE</a>
                </li>
                {% end %}
                {% if "webui" not in disable_links %}
                <li>
                    <a href="/firefox" target="_blank">WebUI</a>
                </li>
                {% end %}
                {% if "cvp" not in disable_links %}
                <li>
                    <a href="/cv" target="_blank">CVP</a>
                </li>
                {% end %}
                {% if "jenkins" not in disable_links %}
                <li>
                    <a href="/jenkins" target="_blank">Jenkins</a>
                </li>
                {% end %}
                <li>
                    <a style="color: white;cursor: pointer;" id="labMenu"  target="_blank">Lab Menu</a>
                </li>
            </ul>
        </div>
        <!-- /#sidebar-wrapper -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container-fluid">
                <div id="mainContent">
                <h1>Arista {{ topo_title }}</h1>
                Welcome to the Arista {{ topo_title }}! Please use the links on the left to navigate through the lab.
                <br><br>
                <h4>Time Remaining: <span id="countdown_timer">00:00:00</span></h4>
                <br />
                <h2>Topology</h2>
                Click on a device to access CLI.
                <br />
                <img src="topo/atd-topo.png" usemap="#image_map">
                <map name="image_map">
                    {% for node in NODES %}
                    {% if node == "CVP" %}
                        <area alt="{{ escape(node) }}" title="{{ escape(node) }}" href="/cv" target="_blank" coords="{{ escape(NODES[node]['coords']) }}" shape="rect">
                    {% else %}
                        <area alt="{{ escape(node) }}" title="{{ escape(node) }}" href="/ssh/host/{{ escape(NODES[node]['ip']) }}" target="_blank" coords="{{ escape(NODES[node]['coords']) }}" shape="rect">
                    {% end %}
                    {% end %}
                </map>
                <br /><br />
                {% if topo_cvp %}
                    <span id="cvp_info"></span>
                    <br /><br />
                {% end %}
                <h2>Usernames and Passwords</h2>
                Use the following usernames and passwords to access the ATD:
                <br>
                <br>
                <table class="table table-striped">
                  <thead> <tr> <th>Device</th> <th>Username</th> <th>Password</th> </tr> </thead>
                  <tbody> 
                    <tr><td>Lab Credentials</td> <td>arista</td> <td>{{ ARISTA_PWD }}</td> </tr>
                    <tr><td>Programmability IDE</td> <td></td><td>{{ ARISTA_PWD }}</td></tr>
                    <tr><td>WebUI</td> <td></td><td>@rista1</td></tr>
                  </tbody> </table>

                <br>
            </div>
            <div id="labMenuDiv" style="display: none;">
            <h2>Lab Menu</h2>
           
            <div id="statistics-table">
                {% for key, value in menu_options.items() %}
                <input type="radio" name="lab" value="{{key}}" /> {{value}}<br />
                {% end %}
              </div>
              <button id="labBtn">Start Lab</button>
              <p id="apiResponse"></p>
            </div>
        </div>
            </div>
        </div>
        <!-- /#page-content-wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- Bootstrap core JavaScript -->
    <script src="js/jquery.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script>
        $('#labMenu').click(function(event) {
        document.getElementById('labMenuDiv').style.display = 'block'
        document.getElementById('mainContent').style.display = 'none'
        // mainContent
        });
        $('#home').click(function(event) {
        document.getElementById('labMenuDiv').style.display = 'none'
        document.getElementById('mainContent').style.display = 'block'
        // mainContent
        })
        
    document.getElementById("labBtn").addEventListener("click", function () {        
        const selected_lab_options = document.querySelector('input[name="lab"]:checked').value;
        document.getElementById('loader').style.display = 'block'
        $.get( "/lab?lab_value="+selected_lab_options,(res)=>{
            console.log(res)
            if(res.response){
                output = ''
                res.response.forEach(element => {
                    output =  output + element 
                });
                document.getElementById('apiResponse').textContent = output
                document.getElementById('loader').style.display = 'none'

            }
        })


      });
    </script>

</body>

</html>
